{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst apiKey = '50867050-92eb7eb537c2ba6b1fec3ca38';\nconst baseUrl = 'https://pixabay.com/api/';\n\nexport async function getImagesByQuery(query, page = 1) {\n  try {\n    const respons = await axios.get(baseUrl, {\n      params: {\n        key: apiKey,\n        q: query,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: true,\n        page,\n        per_page: 15,\n      },\n    });\n    return respons.data;\n  } catch (err) {\n    console.error(err);\n    throw err;\n  }\n}\n","// Описаний у документації\nimport SimpleLightbox from 'simplelightbox';\n// Додатковий імпорт стилів\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nlet lightbox;\n\nexport function createGallery(images) {\n  const markup = images\n    .map(image => {\n      return `<li class =\"gallery-item\">\n            <a class = \"gallery-link\" href= \"${image.largeImageURL}\">\n            <img class=\"gallery-image\" src=\"${image.webformatURL}\" alt =\"${image.tags}\"/>\n            </a>\n            <div class=\"gallery-info\">\n                <div class=\"gallery-view\">Likes<p class=\"gallery-count\">${image.likes}</p></div>\n                <div class=\"gallery-view\">Views<p class=\"gallery-count\">${image.views}</p></div>\n                <div class=\"gallery-view\">Comments<p class=\"gallery-count\">${image.comments}</p></div>\n                <div class=\"gallery-view\">Downloads<p class=\"gallery-count\">${image.downloads}</p></div>\n            </div>\n            </li>`;\n    })\n    .join('');\n\n  const gallery = document.querySelector('.gallery');\n  gallery.insertAdjacentHTML('beforeend', markup);\n\n  if (!lightbox) {\n    lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionPosition: 'bottom',\n      captionDelay: 250,\n    });\n  }\n  lightbox.refresh();\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport { getImagesByQuery } from './js/pixabay-api';\nimport { createGallery } from './js/render-functions';\n\nconst form = document.querySelector('.form');\nconst searchInput = document.querySelector('input[name=\"search-text\"]');\nconst loader = document.querySelector('.loader');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreBtn = document.querySelector('.button-load-more');\nlet userInput = '';\nlet page = 1;\nlet totalLoaded = 0;\nlet totalHits = 0;\n\nfunction waitForImagesToLoad(container) {\n  const images = container.querySelectorAll('img');\n  const promises = Array.from(images).map(img => {\n    return new Promise(resolve => {\n      if (img.complete) {\n        resolve();\n      } else {\n        img.addEventListener('load', resolve);\n        img.addEventListener('error', resolve);\n      }\n    });\n  });\n  return Promise.all(promises);\n}\n\nform.addEventListener('submit', async event => {\n  event.preventDefault();\n\n  userInput = searchInput.value.trim();\n  if (userInput === '') {\n    iziToast.error({\n      message: 'Please enter a search query.',\n      position: 'topRight',\n      progressBar: false,\n    });\n    return;\n  }\n\n  gallery.innerHTML = '';\n  page = 1;\n\n  loader.classList.remove('hidden');\n  loadMoreBtn.classList.replace('load-more', 'load-more-hidden');\n\n  try {\n    const data = await getImagesByQuery(userInput, page);\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        iconColor: '#fafafb',\n        iconUrl:\n          'data:image/svg+xml;utf8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"24\" height=\"24\" viewBox=\"0 0 24 24\" fill=\"none\"><path d=\"M6.81 0.219C6.95056 0.0787966 7.14097 4.21785e-05 7.3395 0L16.6605 0C16.859 4.21785e-05 17.0494 0.0787966 17.19 0.219L23.781 6.81C23.9212 6.95056 24 7.14097 24 7.3395V16.6605C24 16.859 23.9212 17.0494 23.781 17.19L17.19 23.781C17.0494 23.9212 16.859 24 16.6605 24H7.3395C7.14097 24 6.95056 23.9212 6.81 23.781L0.219 17.19C0.0787966 17.0494 4.21785e-05 16.859 0 16.6605V7.3395C4.21785e-05 7.14097 0.0787966 6.95056 0.219 6.81L6.81 0.219ZM7.65 1.5L1.5 7.65V16.35L7.65 22.5H16.35L22.5 16.35V7.65L16.35 1.5H7.65Z\" fill=\"%23FAFAFB\"/><path d=\"M6.96888 6.969C7.03854 6.89915 7.12131 6.84374 7.21243 6.80593C7.30354 6.76812 7.40122 6.74866 7.49988 6.74866C7.59853 6.74866 7.69621 6.76812 7.78733 6.80593C7.87844 6.84374 7.96121 6.89915 8.03088 6.969L11.9999 10.9395L15.9689 6.969C16.0386 6.89927 16.1214 6.84395 16.2125 6.80621C16.3036 6.76847 16.4013 6.74905 16.4999 6.74905C16.5985 6.74905 16.6961 6.76847 16.7873 6.80621C16.8784 6.84395 16.9611 6.89927 17.0309 6.969C17.1006 7.03873 17.1559 7.12151 17.1937 7.21262C17.2314 7.30373 17.2508 7.40138 17.2508 7.5C17.2508 7.59861 17.2314 7.69626 17.1937 7.78737C17.1559 7.87848 17.1006 7.96127 17.0309 8.031L13.0604 12L17.0309 15.969C17.1006 16.0387 17.1559 16.1215 17.1937 16.2126C17.2314 16.3037 17.2508 16.4014 17.2508 16.5C17.2508 16.5986 17.2314 16.6963 17.1937 16.7874C17.1559 16.8785 17.1006 16.9613 17.0309 17.031C16.9611 17.1007 16.8784 17.156 16.7873 17.1938C16.6961 17.2315 16.5985 17.2509 16.4999 17.2509C16.4013 17.2509 16.3036 17.2315 16.2125 17.1938C16.1214 17.156 16.0386 17.1007 15.9689 17.031L11.9999 13.0605L8.03088 17.031C7.96114 17.1007 7.87836 17.156 7.78725 17.1938C7.69614 17.2315 7.59849 17.2509 7.49988 17.2509C7.40126 17.2509 7.30361 17.2315 7.2125 17.1938C7.12139 17.156 7.03861 17.1007 6.96888 17.031C6.89914 16.9613 6.84383 16.8785 6.80609 16.7874C6.76835 16.6963 6.74893 16.5986 6.74893 16.5C6.74893 16.4014 6.76835 16.3037 6.80609 16.2126C6.84383 16.1215 6.89914 16.0387 6.96888 15.969L10.9394 12L6.96888 8.031C6.89903 7.96133 6.84362 7.87857 6.80581 7.78745C6.768 7.69633 6.74854 7.59865 6.74854 7.5C6.74854 7.40135 6.768 7.30366 6.80581 7.21255C6.84362 7.12143 6.89903 7.03867 6.96888 6.969Z\" fill=\"%23FAFAFB\"/></svg>',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        progressBar: false,\n        backgroundColor: '#ef4040',\n        messageColor: '#fafafb',\n      });\n      gallery.innerHTML = '';\n      loader.classList.add('hidden');\n      loadMoreBtn.classList.replace('load-more', 'load-more-hidden');\n      form.reset();\n      return;\n    }\n\n    totalHits = data.totalHits;\n    totalLoaded = data.hits.length;\n\n    createGallery(data.hits);\n\n    await waitForImagesToLoad(gallery);\n    loader.classList.add('hidden');\n\n    if (totalLoaded < totalHits) {\n      loadMoreBtn.classList.replace('load-more-hidden', 'load-more');\n    }\n  } catch (err) {\n    iziToast.error({\n      message: 'Something went wrong. Please try again later.',\n      position: 'topCenter',\n    });\n    loader.classList.add('hidden');\n  }\n\n  form.reset();\n});\n\nloadMoreBtn.addEventListener('click', handleClick);\n\nasync function handleClick() {\n  page += 1;\n  loadMoreBtn.classList.replace('load-more', 'load-more-hidden');\n  loader.classList.remove('hidden');\n\n  try {\n    waitForImagesToLoad(gallery);\n    const data = await getImagesByQuery(userInput, page);\n\n    createGallery(data.hits);\n\n    await waitForImagesToLoad(gallery);\n    loader.classList.add('hidden');\n    totalLoaded += data.hits.length;\n\n    loadMoreBtn.classList.replace('load-more-hidden', 'load-more');\n\n    if (totalLoaded < totalHits) {\n      loadMoreBtn.classList.replace('load-more-hidden', 'load-more');\n    } else {\n      loadMoreBtn.classList.replace('load-more', 'load-more-hidden');\n      iziToast.error({\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n        progressBar: false,\n        backgroundColor: '#9edce8',\n      });\n    }\n\n    const card = document.querySelector('.gallery-item');\n    const cardHeight = card.getBoundingClientRect().height;\n\n    window.scrollBy({\n      left: 0,\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    iziToast.error({\n      message: 'Ooops! Something went wrong. Please try again later.',\n      position: 'topRight',\n      progressBar: false,\n    });\n  }\n}\n"],"names":["apiKey","baseUrl","getImagesByQuery","query","page","axios","err","lightbox","createGallery","images","markup","image","SimpleLightbox","form","searchInput","loader","gallery","loadMoreBtn","userInput","totalLoaded","totalHits","waitForImagesToLoad","container","promises","img","resolve","event","iziToast","data","handleClick","cardHeight"],"mappings":"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"}